---
sticker: emoji//1f600
---
## 필터
(서블릿이 제공하는 기능)
필터를 사용하는 이유
ex) 로그인 하지 않은 사용자도 다음 URL을 직접 호출하면 그 url에 접근이 가능하다
## 만약에 필터가 없다면?

 컨트롤러에서 로그인 여부를 체크하는 로직을 하나하나 작성하면 되겠지만, 등록, 수정, 삭제, 조회 등등  모든 컨트롤러 로직에 공통으로 로그인 여부를 확인해야 한다. 더 큰 문제는 향후 로그인과 관련된 로직이 변경될 때 이다. 작성한 모든 로직을 다 수정해야 할 수 있다.

### 공통 관심사

애플리케이션 여러 로직에서 공통으로 관심이 있는 있는 것을 공통 관심사(cross-cutting concern)라고 한다

웹과 관련된 공통 관심사는  서블릿 필터 또는 스프링 인터셉터를 사용하는 것이 좋다. 웹과 관련된 공통 관심사를 처리할 때는 HTTP의 헤더나 URL의 정보들이 필요한데, 서블릿 필터나 스프링 인터셉터는 HttpServletRequest 를 제공한다

## 필터의 흐름 이란

HTTP 요청 -> WAS -> 필터 -> 서블릿 -> 컨트롤러

서블릿 : 스프링이니깐 dispatcherservlet

## 필터 체인
HTTP 요청 -> WAS -> 필터1 -> 필터2 -> 필터3 -> 서블릿 -> 컨트롤러
## 필터 인터페이스

- init(): 필터 초기화 메서드, 서블릿 컨테이너가 생성될 때 호출된다. 
- doFilter(): 고객의 요청이 올 때 마다 해당 메서드가 호출된다. 필터의 로직을 구현하면 된다. 
- destroy(): 필터 종료 메서드, 서블릿 컨테이너가 종료될 때 호출된다.

 
## 인터셉터
(스프링이 제공하는 기능)
필터랑 역할은 똑같다 하지만 훨씬 정밀하게 설정할 수 있다. 

## 인터셉터의 흐름
HTTP 요청 -> WAS -> 필터 -> 서블릿 -> 스프링 인터셉터 -> 컨트롤러

## 인터셉터의 제한
HTTP 요청 -> WAS -> 필터 -> 서블릿 -> 스프링 인터셉터 -> 컨트롤러 //로그인 사용자 

HTTP 요청 -> WAS -> 필터 -> 서블릿 -> 스프링 인터셉터(적절하지 않은 요청이라 판단, 컨트롤러 호출 X) // 비 로그인 사용자

## 인터셉터의 체인

HTTP 요청 -> WAS -> 필터 -> 서블릿 -> 인터셉터1 -> 인터셉터2 -> 컨트롤러

preHandle : 컨트롤러 호출 전에 호출된다. (더 정확히는 핸들러 어댑터 호출 전에 호출된다.) preHandle 의 응답값이 true 이면 다음으로 진행하고, false 이면 더는 진행하지 않는다. false 인 경우 나머지 인터셉터는 물론이고, 핸들러 어댑터도 호출되지 않는다. 그림에서 1번에서 끝이 나버린다.

postHandle : 컨트롤러 호출 후에 호출된다. (더 정확히는 핸들러 어댑터 호출 후에 호출된다.) 


afterCompletion : 뷰가 렌더링 된 이후에 호출된다

![[Pasted image 20231108000933.png]]
## 